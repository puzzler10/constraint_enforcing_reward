2024-02-25 22:02:17,418 INFO    MainThread:2821627 [wandb_setup.py:_flush():75] Loading settings from /home/tproth/.config/wandb/settings
2024-02-25 22:02:17,418 INFO    MainThread:2821627 [wandb_setup.py:_flush():75] Loading settings from /data/tproth/travis_release/wandb/settings
2024-02-25 22:02:17,418 INFO    MainThread:2821627 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2024-02-25 22:02:17,418 INFO    MainThread:2821627 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': 'run.py', 'program': '/data/tproth/travis_release/run.py'}
2024-02-25 22:02:17,420 INFO    MainThread:2821627 [wandb_init.py:_log_setup():386] Logging user logs to /data/tproth/travis_release/wandb/run-20240225_220217-2gl3k72f/logs/debug.log
2024-02-25 22:02:17,421 INFO    MainThread:2821627 [wandb_init.py:_log_setup():387] Logging internal logs to /data/tproth/travis_release/wandb/run-20240225_220217-2gl3k72f/logs/debug-internal.log
2024-02-25 22:02:17,421 INFO    MainThread:2821627 [wandb_init.py:init():420] calling init triggers
2024-02-25 22:02:17,422 INFO    MainThread:2821627 [wandb_init.py:init():425] wandb.init called with sweep_config: {}
config: {'pp_name': 'prithivida/parrot_paraphraser_on_T5', 'dataset_name': 'financial', 'sts_name': 'sentence-transformers/paraphrase-MiniLM-L12-v2', 'nli_name': 'howey/electra-small-mnli', 'cola_name': 'textattack/albert-base-v2-CoLA', 'vm_name': 'mrm8488/distilroberta-finetuned-financial-news-sentiment-analysis', 'seed': 420, 'use_small_ds': False, 'lr': 8e-05, 'batch_size_train': 16, 'batch_size_eval': 16, 'acc_steps': 2, 'eval_freq': 1, 'early_stopping_min_epochs': 8, 'n_train_epochs': 10, 'reward_fn': 'reward_fn_contradiction_and_letter_diff', 'reward_clip_max': 4, 'reward_clip_min': 0, 'reward_base': 0, 'reward_vm_multiplier': 12, 'sts_threshold': 0.8, 'acceptability_threshold': 0.5, 'contradiction_threshold': 0.2, 'pp_letter_diff_threshold': 30, 'reward_penalty_type': 'kl_div', 'kl_coef': 0.25, 'ref_logp_coef': None, 'min_pp_length': 3, 'max_pp_length': 48, 'n_eval_seq': 8, 'decode_method_train': 'sample', 'decode_method_eval': 'beam_search', 'gen_params_train': {'do_sample': True, 'temperature': 1, 'top_p': 0.95}, 'gen_params_eval': {'num_return_sequences': 8, 'do_sample': False, 'num_beams': 8, 'top_p': None, 'temperature': None, 'diversity_penalty': None, 'num_beam_groups': 1}, 'early_stopping': True, 'early_stopping_metric': 'any_adv_example_proportion', 'orig_max_length': 32, 'pin_memory': True, 'zero_grad_with_none': False, 'orig_padding_multiple': 8, 'bucket_by_length': True, 'shuffle_train': False, 'remove_misclassified_examples': True, 'remove_long_orig_examples': True, 'unfreeze_last_n_layers': 'all', 'n_shards': None, 'shard_contiguous': None, 'wandb': {'project': 'travis_attack', 'entity': 'uts_nlp', 'mode': 'online', 'log_grads': False, 'log_grads_freq': 1, 'log_token_entropy': True, 'log_token_probabilities': True, 'run_notes': ''}, 'device': device(type='cuda'), 'devicenum': 0, 'n_wkrs': 4, 'datetime_run': '2024-02-25_215827', 'path_data': './data/', 'path_checkpoints': '../model_checkpoints/travis_attack/', 'path_run': None, 'path_data_cache': '/data/tproth/.cache/huggingface/datasets/', 'path_logs': './logs/', 'path_logfile': './logs/run_2024-02-25_215827.txt', 'path_ref_pp_baselines': './baselines/ref_pp_baselines/', 'path_results': './results/', 'orig_cname': 'sentence', 'label_cname': 'label', 'vm_num_labels': 3, 'vocab_size': 32128, 'contra_label': 2, 'cola_positive_label': 1, 'ds_length': {'train': 1370, 'valid': 167, 'test': 159}, 'dl_n_batches': {'train': 86, 'valid': 11, 'test': 10, 'train_eval': 86}, 'dl_leftover_batch_size': {'train': 10, 'valid': 7, 'test': 15, 'train_eval': 10}, 'dl_batch_sizes': {'train': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 10], 'valid': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 7], 'test': [16, 16, 16, 16, 16, 16, 16, 16, 16, 15], 'train_eval': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 10]}, 'n_train_steps': 860, 'acc_leftover_batches': 0}
2024-02-25 22:02:17,423 INFO    MainThread:2821627 [wandb_init.py:init():471] starting backend
2024-02-25 22:02:17,423 INFO    MainThread:2821627 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-02-25 22:02:18,280 INFO    MainThread:2821627 [backend.py:ensure_launched():219] starting backend process...
2024-02-25 22:02:18,315 INFO    MainThread:2821627 [backend.py:ensure_launched():224] started backend process with pid: 2826051
2024-02-25 22:02:18,316 INFO    MainThread:2821627 [wandb_init.py:init():480] backend started and connected
2024-02-25 22:02:18,320 INFO    MainThread:2821627 [wandb_init.py:init():550] updated telemetry
2024-02-25 22:02:18,322 INFO    MainThread:2821627 [wandb_init.py:init():581] communicating current version
2024-02-25 22:02:21,901 INFO    MainThread:2821627 [wandb_init.py:init():586] got version response upgrade_message: "wandb version 0.16.3 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-02-25 22:02:21,902 INFO    MainThread:2821627 [wandb_init.py:init():596] communicating run to backend with 30 second timeout
2024-02-25 22:02:22,237 INFO    MainThread:2821627 [wandb_init.py:init():624] starting run threads in backend
2024-02-25 22:02:27,246 INFO    MainThread:2821627 [wandb_run.py:_console_start():1827] atexit reg
2024-02-25 22:02:27,277 INFO    MainThread:2821627 [wandb_run.py:_redirect():1701] redirect: SettingsConsole.REDIRECT
2024-02-25 22:02:27,278 INFO    MainThread:2821627 [wandb_run.py:_redirect():1706] Redirecting console.
2024-02-25 22:02:27,280 INFO    MainThread:2821627 [wandb_run.py:_redirect():1762] Redirects installed.
2024-02-25 22:02:27,280 INFO    MainThread:2821627 [wandb_init.py:init():651] run started, returning control to user process
