2023-02-02 15:08:28,517 INFO    MainThread:16687 [wandb_setup.py:_flush():75] Loading settings from /home/tproth/.config/wandb/settings
2023-02-02 15:08:28,518 INFO    MainThread:16687 [wandb_setup.py:_flush():75] Loading settings from /data/tproth/travis_release/wandb/settings
2023-02-02 15:08:28,518 INFO    MainThread:16687 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2023-02-02 15:08:28,519 WARNING MainThread:16687 [wandb_setup.py:_flush():75] Could not save program above cwd: /home/tproth/Data/travis_release/run.py
2023-02-02 15:08:28,519 INFO    MainThread:16687 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': None, 'program': '/home/tproth/Data/travis_release/run.py'}
2023-02-02 15:08:28,520 INFO    MainThread:16687 [wandb_init.py:_log_setup():386] Logging user logs to /data/tproth/travis_release/wandb/run-20230202_150828-tyvteeqw/logs/debug.log
2023-02-02 15:08:28,520 INFO    MainThread:16687 [wandb_init.py:_log_setup():387] Logging internal logs to /data/tproth/travis_release/wandb/run-20230202_150828-tyvteeqw/logs/debug-internal.log
2023-02-02 15:08:28,521 INFO    MainThread:16687 [wandb_init.py:init():420] calling init triggers
2023-02-02 15:08:28,521 INFO    MainThread:16687 [wandb_init.py:init():425] wandb.init called with sweep_config: {}
config: {'pp_name': 'prithivida/parrot_paraphraser_on_T5', 'dataset_name': 'financial', 'sts_name': 'sentence-transformers/paraphrase-MiniLM-L12-v2', 'nli_name': 'howey/electra-small-mnli', 'cola_name': 'textattack/albert-base-v2-CoLA', 'vm_name': 'mrm8488/distilroberta-finetuned-financial-news-sentiment-analysis', 'seed': 420, 'use_small_ds': True, 'lr': 8e-05, 'batch_size_train': 16, 'batch_size_eval': 16, 'acc_steps': 2, 'eval_freq': 1, 'early_stopping_min_epochs': 8, 'n_train_epochs': 10, 'reward_fn': 'reward_fn_contradiction_and_letter_diff', 'reward_clip_max': 4, 'reward_clip_min': 0, 'reward_base': 0, 'reward_vm_multiplier': 12, 'sts_threshold': 0.8, 'acceptability_threshold': 0.5, 'contradiction_threshold': 0.2, 'pp_letter_diff_threshold': 30, 'reward_penalty_type': 'kl_div', 'kl_coef': 0.25, 'ref_logp_coef': None, 'min_pp_length': 3, 'max_pp_length': 48, 'n_eval_seq': 8, 'decode_method_train': 'sample', 'decode_method_eval': 'beam_search', 'gen_params_train': {'do_sample': True, 'temperature': 1, 'top_p': 0.95}, 'gen_params_eval': {'num_return_sequences': 8, 'do_sample': False, 'num_beams': 8, 'top_p': None, 'temperature': None, 'diversity_penalty': None, 'num_beam_groups': None}, 'early_stopping': True, 'early_stopping_metric': 'any_adv_example_proportion', 'orig_max_length': 32, 'pin_memory': True, 'zero_grad_with_none': False, 'orig_padding_multiple': 8, 'bucket_by_length': True, 'shuffle_train': False, 'remove_misclassified_examples': True, 'remove_long_orig_examples': True, 'unfreeze_last_n_layers': 'all', 'n_shards': 3, 'shard_contiguous': False, 'wandb': {'project': 'travis_attack', 'entity': 'uts_nlp', 'mode': 'online', 'log_grads': False, 'log_grads_freq': 1, 'log_token_entropy': True, 'log_token_probabilities': True, 'run_notes': ''}, 'device': device(type='cuda'), 'devicenum': 0, 'n_wkrs': 4, 'datetime_run': '2023-02-02_150736', 'path_data': './data/', 'path_checkpoints': '../model_checkpoints/travis_attack/', 'path_run': None, 'path_data_cache': '/data/tproth/.cache/huggingface/datasets/', 'path_logs': './logs/', 'path_logfile': './logs/run_2023-02-02_150736.txt', 'path_ref_pp_baselines': './baselines/ref_pp_baselines/', 'path_results': './results/', 'orig_cname': 'sentence', 'label_cname': 'label', 'vm_num_labels': 3, 'vocab_size': 32128, 'contra_label': 2, 'cola_positive_label': 1, 'ds_length': {'train': 458, 'valid': 65, 'test': 55}, 'dl_n_batches': {'train': 29, 'valid': 5, 'test': 4, 'train_eval': 29}, 'dl_leftover_batch_size': {'train': 10, 'valid': 1, 'test': 7, 'train_eval': 10}, 'dl_batch_sizes': {'train': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 10], 'valid': [16, 16, 16, 16, 1], 'test': [16, 16, 16, 7], 'train_eval': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 10]}, 'n_train_steps': 290, 'acc_leftover_batches': 0}
2023-02-02 15:08:28,522 INFO    MainThread:16687 [wandb_init.py:init():471] starting backend
2023-02-02 15:08:28,522 INFO    MainThread:16687 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-02-02 15:08:28,531 INFO    MainThread:16687 [backend.py:ensure_launched():219] starting backend process...
2023-02-02 15:08:28,535 INFO    MainThread:16687 [backend.py:ensure_launched():224] started backend process with pid: 18106
2023-02-02 15:08:28,538 INFO    MainThread:16687 [wandb_init.py:init():480] backend started and connected
2023-02-02 15:08:28,542 INFO    MainThread:16687 [wandb_init.py:init():550] updated telemetry
2023-02-02 15:08:28,544 INFO    MainThread:16687 [wandb_init.py:init():581] communicating current version
2023-02-02 15:08:31,717 INFO    MainThread:16687 [wandb_init.py:init():586] got version response upgrade_message: "wandb version 0.13.9 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-02-02 15:08:31,718 INFO    MainThread:16687 [wandb_init.py:init():596] communicating run to backend with 30 second timeout
2023-02-02 15:08:32,035 INFO    MainThread:16687 [wandb_init.py:init():624] starting run threads in backend
2023-02-02 15:08:37,047 INFO    MainThread:16687 [wandb_run.py:_console_start():1827] atexit reg
2023-02-02 15:08:37,052 INFO    MainThread:16687 [wandb_run.py:_redirect():1701] redirect: SettingsConsole.REDIRECT
2023-02-02 15:08:37,053 INFO    MainThread:16687 [wandb_run.py:_redirect():1706] Redirecting console.
2023-02-02 15:08:37,060 INFO    MainThread:16687 [wandb_run.py:_redirect():1762] Redirects installed.
2023-02-02 15:08:37,061 INFO    MainThread:16687 [wandb_init.py:init():651] run started, returning control to user process
